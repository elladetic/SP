---
title: "DZ2"
author: "Eleonora Detić"
date: "11/1/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Zadatak 3 - Cijena dionice

## a dio
```{r}
#grafičko testiranje ovisnosti
dionica = read.csv("dionica.csv") #učitavanje podataka
par(mfrow=c(2,2)) 
plot(dionica$BDP, dionica$Cijena, col="red")
plot(dionica$ZAP, dionica$Cijena, col="blue") #moguća zavisnost
plot(dionica$KS, dionica$Cijena, col="green")
plot(dionica$MJ, dionica$Cijena, col= "orange") #moguća zavisnost

#testiranje ovisnosti kroz model
model = lm(dionica$Cijena ~ dionica$BDP+dionica$ZAP+dionica$KS+dionica$MJ)
summary(model) 
#mali p value - model statisticki značajan
#ZAP zavisan najviše, MJ nakon njega, BDP nije tolko važan za cijenu
```
## b dio
```{r}
#pouzdana pruga za srednju vrijednost
plot(dionica$Cijena)
matrica = predict(model, level=0.9, i="c") 
matrica = as.data.frame(matrica)
plot(dionica$Cijena)
lines(matrica$lwr, col="red") 
lines(matrica$upr, col="red")
```
## c dio
```{r}
#testiranje da je koeficijent uz kamatna stopu 100

model2 = lm(dionica$Cijena ~dionica$BDP+dionica$ZAP+ offset(100*dionica$KS)+dionica$MJ)
anova(model2,model)
#velika p vrijednost, ne odbacujemo nul hipotezu, znaci da je ovaj koeficijent 100

```

## d dio
```{r}
nove_dionice = read.csv("nova_cijena.csv") #učitavanje podataka
novi_model = lm(nove_dionice$Cijena ~ nove_dionice$BDP+nove_dionice$ZAP+nove_dionice$KS+nove_dionice$MJ)
predict(novi_model, i="c")
dionica$Cijena

#Ninin i Tein nacin
matrica2 = predict(novi_model, level=0.9, i="p")
matrica2 = as.data.frame(matrica2)
plot(dionica$Cijena)
lines(matrica2$lwr, col="red") 
lines(matrica2$upr, col="red")
#obrnuto
plot(nove_dionice$Cijena)
lines(matrica$lwr, col="blue") 
lines(matrica$upr, col="blue")

#dionica ima 24 tocke
#nove_dionice imaju 12 tocaka

anova(model, novi_model)
AIC(model)
AIC(novi_model)
BIC(model)
BIC(novi_model)
#bolji model je ovaj novi
```

## e dio
```{r}
#uklananje točaka radi poboljšanja prediktivne vrijednosti
library(base)

distance = cooks.distance(model)
length(distance[distance > 0.5]) 
#nema utjecajnih tocaka 
```


### Zadatak 4

## a dio
```{r}
prodaja = read.table("prodaja.dat", header=TRUE) 
model = lm(prodaja$kolicina~prodaja$dan)
summary(model)
```

## b dio - provjera pretpostavki linearnog modela
```{r}
#1.linearnost podataka
res = resid(model)
plot(prodaja$dan, res) 
abline(a=0,b=0)
#raspršenje oko apcise ukazuje na nelinearnost

#2.nezavisnost grešaka
library(lmtest)
dwtest(model)
#mala p vrijednost, odbacujemo null hipotezu 
#nul hipoteza je da ne postoji korelacija 

#3. homogenost greška

#4. normalnost greška
```

## c dio
```{r}

```












