---
title: "DZ2"
author: "Eleonora Detić"
date: "11/1/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Zadatak 3
## a dio
```{r}
#Grafičko testiranje ovisnosti
dionica = read.csv("dionica.csv") #učitavanje podataka
par(mfrow=c(2,2)) 
plot(dionica$BDP, dionica$Cijena, col="red")
plot(dionica$ZAP, dionica$Cijena, col="blue") #ovo mi se cini kao zavisno
plot(dionica$KS, dionica$Cijena, col="green")
plot(dionica$MJ, dionica$Cijena, col= "orange") #i ovo bi moglo proc pod zavisno?

## testiranje ovisnosti kroz model
model = lm(dionica$Cijena ~ dionica$BDP+dionica$ZAP+dionica$KS+dionica$MJ)
summary(model) #vec tu vidim procjenu da mi je koef od dionice 200 i nest
#dobar model, BDP nije ovisan
#mali p value znaci da mi je model statisticki znacaj
```
## b dio
```{r}
plot(dionica$Cijena)
matrica = predict(model, level=0.9, i="c") 
#srednja vrijednost #i = "c" znaci confidence - interval pouzdanosti
matrica = as.data.frame(matrica)
plot(dionica$Cijena)
lines(matrica$lwr, col="red") 
lines(matrica$upr, col="red")
```
### c dio
```{r}
model2 = lm(dionica$Cijena ~dionica$BDP+dionica$ZAP+ offset(100*dionica$KS)+dionica$MJ)
#nisam sigurna jel ovo okej
#tak nest slicno oni rade na prezentacijama
anova(model2,model)
#velika p vrijednost, ne odbacujemo nul hipotezu, znaci da je ovaj koeficijent 100
```
### d dio

```{r}
nove_dionice = read.csv("nova_cijena.csv") #učitavanje podataka
novi_model = lm(nove_dionice$Cijena ~ nove_dionice$BDP+nove_dionice$ZAP+nove_dionice$KS+nove_dionice$MJ)
predict(novi_model, i="c")
dionica$Cijena

#Ninin i Tein nacin
matrica2 = predict(novi_model, level=0.9, i="p")
matrica2 = as.data.frame(matrica2)
plot(dionica$Cijena)
lines(matrica2$lwr, col="red") 
lines(matrica2$upr, col="red")
#obrnuto
plot(nove_dionice$Cijena)
lines(matrica$lwr, col="blue") 
lines(matrica$upr, col="blue")

#dionica ima 24 tocke
#nove_dionice imaju 12 tocaka

anova(model, novi_model)
AIC(model)
AIC(novi_model)
BIC(model)
BIC(novi_model)
#bolji model je ovaj novi
```
## e dio
```{r}
#detekcija outlinera
library(base)

#stari model
distance = cooks.distance(model)
length(distance[distance > 0.5]) #nema utjecajnih tocaka ?

#novi model -> netreba gledati drugi model!
distance = cooks.distance(novi_model)
length(distance[distance > 0.5]) 
# u starom modelu nema takvih tocaka, u novom su dvije 
```


### Zadatak 4

# a dio
```{r}
# a dio - jel ovdje x kao dan?
prodaja = read.table("prodaja.dat", header=TRUE) #oprez, čitanje .dat file-ova
model = lm(prodaja$kolicina~prodaja$dan)
#checkresiduals(model) #šta je ovo wtf

# b dio
plot.ts(prodaja$kolicina) #postoji trend i šum vrlo vjerojatno

```














